<!DOCTYPE html>
<head>
  <script src="https://apis.mapmyindia.com/advancedmaps/v1/
	fxqpb29bi12jc1gym1sefnh5vf6fabxo
	/map_load?v=1.3"></script>
  <style>
    html,
    body,
    #map {
      margin: 0;
      padding: 0;
      width: 100%;
      height: 100%;
    }
    .map_marker {
      position: relative;
      width: 34px;
      height: 48px;
    }

    .my-div-span {
      position: absolute;
      left: 1.5em;
      right: 1em;
      top: 1.4em;
      bottom: 2.5em;
      font-size: 9px;
      font-weight: bold;
      width: 1px;
      color: black;
    }
  </style>
</head>
<body>
  <div id="map"></div>
</body>
<script>
  var marker = [];
  var map;
  var weightCapacity, heightCapacity;
  var url;

  window.onload = function() {
    fetch("http://192.168.56.1:3000/")
      .then(response => {
        return response.json();
      })
      .then(data => {
        // Work with JSON data here
        console.log(data);
      })
      .catch(err => {
        // Do something for an error here
      });

    map = new MapmyIndia.Map("map", {
      center: [13.13, 77.59],
      zoomControl: true,
      hybrid: true
    });
    map.setZoom(12);
    var mk1 = new L.marker([13.13, 77.59]).addTo(map);

    var mk2 = L.marker([13.13, 77.592]).addTo(map);
    var mk3 = L.marker([13.13, 77.57]).addTo(map);
    var mk4 = L.marker([13.138, 77.57]).addTo(map);

    url = "http://192.168.56.1:3000/bin/binDetails?binId=b001";

    fetch(url)
      .then(response => {
        return response.json();
      })
      .then(data => {
        // Work with JSON data here
        weightCapacity = data.weight;
        heightCapacity = data.height;
        var bindElt = document.createElement("div");
        var h3Elt = document.createElement("h3");
        h3Elt.innerHTML = "Bin:b001";
        bindElt.append(h3Elt);
        var newDiv = document.createElement("div");
        newDiv.class = "mk1";
        newDiv.appendChild(document.createTextNode("Current Weight:"));

        var newSpanWeight = document.createElement("span");
        newSpanWeight.innerHTML = weightCapacity;
        newDiv.append(newSpanWeight);
        newDiv.appendChild(document.createTextNode("%"));
        newDiv.append(document.createElement("p"));
        newDiv.appendChild(document.createTextNode(" Current Height:"));
        var newSpanHeight = document.createElement("span");
        console.log(heightCapacity);
        newSpanHeight.innerHTML = heightCapacity;
        newDiv.append(newSpanHeight);
        newDiv.appendChild(document.createTextNode("%"));
        bindElt.append(newDiv);

        mk1.bindPopup(bindElt);
        document.getElementById("height").innerHTML =
          "<span>" + heightCapacity + "</span>";
        document.getElementById("weight").innerHTML = weightCapacity;
        mk1.on("click", function(e) {
          mk1.openPopup();
        });
      })
      .catch(err => {
        // Do something for an error here
      });

    url = "http://192.168.56.1:3000/bin/binDetails?binId=b002";

    fetch(url)
      .then(response => {
        return response.json();
      })
      .then(data => {
        // Work with JSON data here
        weightCapacity = data.weight;
        heightCapacity = data.height;
        var bindElt = document.createElement("div");
        var h3Elt = document.createElement("h3");
        h3Elt.innerHTML = "Bin:b002";
        bindElt.append(h3Elt);
        var newDiv = document.createElement("div");
        newDiv.class = "mk2";
        newDiv.appendChild(document.createTextNode("Current Weight:"));

        var newSpanWeight = document.createElement("span");
        newSpanWeight.innerHTML = weightCapacity;
        newDiv.append(newSpanWeight);
        newDiv.appendChild(document.createTextNode("%"));
        newDiv.append(document.createElement("p"));
        newDiv.appendChild(document.createTextNode(" Current Height:"));
        var newSpanHeight = document.createElement("span");
        console.log(heightCapacity);
        newSpanHeight.innerHTML = heightCapacity;
        newDiv.append(newSpanHeight);
        newDiv.appendChild(document.createTextNode("%"));
        bindElt.append(newDiv);

        mk2.bindPopup(bindElt);
        document.getElementById("height").innerHTML =
          "<span>" + heightCapacity + "</span>";
        document.getElementById("weight").innerHTML = weightCapacity;
        mk2.on("click", function(e) {
          mk2.openPopup();
        });
      })
      .catch(err => {
        // Do something for an error here
      });

    url = "http://192.168.56.1:3000/bin/binDetails?binId=b003";

    fetch(url)
      .then(response => {
        return response.json();
      })
      .then(data => {
        // Work with JSON data here
        weightCapacity = data.weight;
        heightCapacity = data.height;
        var bindElt = document.createElement("div");
        var h3Elt = document.createElement("h3");
        h3Elt.innerHTML = "Bin:b003";
        bindElt.append(h3Elt);
        var newDiv = document.createElement("div");
        newDiv.class = "mk3";
        newDiv.appendChild(document.createTextNode("Current Weight:"));

        var newSpanWeight = document.createElement("span");
        newSpanWeight.innerHTML = weightCapacity;
        newDiv.append(newSpanWeight);
        newDiv.appendChild(document.createTextNode("%"));
        newDiv.append(document.createElement("p"));
        newDiv.appendChild(document.createTextNode(" Current Height:"));
        var newSpanHeight = document.createElement("span");
        console.log(heightCapacity);
        newSpanHeight.innerHTML = heightCapacity;
        newDiv.append(newSpanHeight);
        newDiv.appendChild(document.createTextNode("%"));
        bindElt.append(newDiv);

        mk3.bindPopup(bindElt);
        document.getElementById("height").innerHTML =
          "<span>" + heightCapacity + "</span>";
        document.getElementById("weight").innerHTML = weightCapacity;
        mk3.on("click", function(e) {
          mk3.openPopup();
        });
      })
      .catch(err => {
        // Do something for an error here
      });
    url = "http://192.168.56.1:3000/bin/binDetails?binId=b004";

    fetch(url)
      .then(response => {
        return response.json();
      })
      .then(data => {
        // Work with JSON data here
        weightCapacity = data.weight;
        heightCapacity = data.height;
        var bindElt = document.createElement("div");
        var h3Elt = document.createElement("h3");
        h3Elt.innerHTML = "Bin:b004";
        bindElt.append(h3Elt);
        var newDiv = document.createElement("div");
        newDiv.class = "mk4";
        newDiv.appendChild(document.createTextNode("Current Weight:"));

        var newSpanWeight = document.createElement("span");
        newSpanWeight.innerHTML = weightCapacity;
        newDiv.append(newSpanWeight);
        newDiv.appendChild(document.createTextNode("%"));
        newDiv.append(document.createElement("p"));
        newDiv.appendChild(document.createTextNode(" Current Height:"));
        var newSpanHeight = document.createElement("span");
        console.log(heightCapacity);
        newSpanHeight.innerHTML = heightCapacity;
        newDiv.append(newSpanHeight);
        newDiv.appendChild(document.createTextNode("%"));
        bindElt.append(newDiv);

        mk4.bindPopup(bindElt);
        document.getElementById("height").innerHTML =
          "<span>" + heightCapacity + "</span>";
        document.getElementById("weight").innerHTML = weightCapacity;
        mk4.on("click", function(e) {
          mk4.openPopup();
        });
      })
      .catch(err => {
        // Do something for an error here
      });
  };
</script>
